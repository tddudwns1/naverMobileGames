"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.exec = void 0;

var _shelljs = _interopRequireDefault(require("shelljs"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var alreadyRunning = false;

var exec = function exec(command, _ref) {
  var onPass = _ref.onPass,
      onFail = _ref.onFail,
      onProgress = _ref.onProgress;

  if (alreadyRunning === true) {
    return;
  }

  alreadyRunning = true;
  var sharedOut = '';

  var child = _shelljs.default.exec(command, {
    async: true,
    silent: true
  }, function (code) {
    alreadyRunning = false;

    if (code === 0) {
      onPass(sharedOut);
    } else {
      onFail(sharedOut);
    }
  });

  child.stdout.on('data', function (data) {
    sharedOut = sharedOut + data;
    onProgress(sharedOut);
  });
  child.stderr.on('data', function (data) {
    sharedOut = sharedOut + data;
    onProgress(sharedOut);
  });
};

exports.exec = exec;